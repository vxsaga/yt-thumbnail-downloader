<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>YouTube Thumbnail & Shorts Downloader</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins&display=swap"
    rel="stylesheet"
  />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* Reset */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 40px 20px;
      font-family: 'Poppins', sans-serif;
      background-color: #121212;
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      display: flex;
      align-items: center;
      gap: 14px;
      margin-bottom: 40px;
    }
    header img {
      height: 36px;
      user-select: none;
    }
    header h1 {
      font-weight: 600;
      font-size: 28px;
      margin: 0;
      user-select: none;
    }

    /* Input container */
    .input-container {
      width: 100%;
      max-width: 540px;
      display: flex;
      gap: 14px;
      margin-bottom: 20px;
    }
    input[type='text'] {
      flex-grow: 1;
      padding: 16px 20px;
      border-radius: 8px;
      border: none;
      font-size: 18px;
      outline: none;
      background-color: #222;
      color: #fff;
      box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
      transition: box-shadow 0.3s ease;
    }
    input[type='text']:focus {
      box-shadow: 0 0 15px #e50914;
    }

    select {
      width: 160px;
      border-radius: 8px;
      border: none;
      background-color: #222;
      color: #fff;
      font-size: 16px;
      padding: 0 10px;
      box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
      transition: box-shadow 0.3s ease;
    }
    select:focus {
      box-shadow: 0 0 15px #e50914;
      outline: none;
    }

    button {
      background-color: #e50914;
      border: none;
      border-radius: 8px;
      color: white;
      font-weight: 600;
      font-size: 18px;
      padding: 0 28px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
      box-shadow: 0 4px 12px rgba(229, 9, 20, 0.6);
      user-select: none;
    }
    button:hover:not(:disabled) {
      background-color: #bf0811;
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(255, 0, 0, 0.8);
    }
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      box-shadow: none;
    }

    /* Result */
    #result, #shorts-result {
      margin-top: 30px;
      max-width: 540px;
      width: 100%;
      text-align: center;
    }
    #result img, #shorts-result img {
      width: 100%;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(255, 0, 0, 0.6);
      user-select: none;
    }
    #download-link, #shorts-download-link {
      display: inline-block;
      margin-top: 16px;
      background-color: #e50914;
      color: #fff;
      padding: 14px 28px;
      border-radius: 8px;
      font-weight: 600;
      text-decoration: none;
      box-shadow: 0 4px 12px rgba(229, 9, 20, 0.6);
      transition: background-color 0.3s ease;
      user-select: none;
    }
    #download-link:hover, #shorts-download-link:hover {
      background-color: #bf0811;
    }

    /* Copy shareable link */
    #copy-share-btn {
      margin-top: 16px;
      padding: 10px 24px;
      background-color: #222;
      border: 2px solid #e50914;
      border-radius: 8px;
      color: #e50914;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease;
      user-select: none;
    }
    #copy-share-btn:hover {
      background-color: #e50914;
      color: white;
    }
    #copy-status {
      margin-top: 8px;
      font-size: 14px;
      color: lightgreen;
      min-height: 18px;
      user-select: none;
    }

    /* Recent searches */
    #recent-searches {
      margin-top: 30px;
      max-width: 540px;
      width: 100%;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    #recent-searches button {
      background: #333;
      color: #eee;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    #recent-searches button:hover {
      background-color: #e50914;
      color: white;
    }

    /* Success/error messages */
    #message, #shorts-message {
      margin-top: 18px;
      font-weight: 600;
      font-size: 16px;
      min-height: 24px;
      user-select: none;
    }
    #message.error, #shorts-message.error {
      color: #f44336;
    }
    #message.success, #shorts-message.success {
      color: #4caf50;
    }

    /* Admin analytics */
    #admin-controls {
      margin-top: 40px;
      max-width: 540px;
      width: 100%;
      text-align: center;
      user-select: none;
    }
    #view-analytics {
      background-color: #222;
      border: 2px solid #e50914;
      color: #e50914;
      font-weight: 600;
      padding: 10px 24px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease;
      margin-bottom: 10px;
    }
    #view-analytics:hover {
      background-color: #e50914;
      color: white;
    }
    #analytics-output {
      background-color: #222;
      color: #fff;
      padding: 12px;
      border-radius: 8px;
      max-height: 240px;
      overflow-y: auto;
      font-family: monospace;
      text-align: left;
      margin-bottom: 20px;
      white-space: pre-wrap;
      user-select: text;
    }
    #analytics-chart {
      max-width: 540px;
      width: 100%;
      height: 300px;
      margin: 0 auto 40px;
    }

    /* Section titles */
    .section-title {
      font-weight: 700;
      font-size: 22px;
      margin-top: 60px;
      margin-bottom: 24px;
      border-bottom: 2px solid #e50914;
      padding-bottom: 8px;
      max-width: 540px;
      width: 100%;
      user-select: none;
    }

    @media (max-width: 600px) {
      header h1 {
        font-size: 22px;
      }
      input[type='text'] {
        font-size: 16px;
      }
      select {
        width: 130px;
        font-size: 14px;
      }
      button {
        font-size: 16px;
        padding: 0 20px;
      }
      #download-link, #shorts-download-link {
        padding: 12px 20px;
        font-size: 16px;
      }
      #copy-share-btn {
        padding: 8px 20px;
        font-size: 14px;
      }
      .section-title {
        font-size: 18px;
        margin-top: 40px;
      }
    }
  </style>
</head>
<body>
  <header>
    <img
      src="https://upload.wikimedia.org/wikipedia/commons/b/b8/YouTube_Logo_2017.svg"
      alt="YouTube Logo"
      draggable="false"
    />
    <h1>YouTube Thumbnail & Shorts Downloader</h1>
  </header>

  <!-- Thumbnail Downloader Section -->
  <section aria-labelledby="thumbnail-section-title">
    <h2 id="thumbnail-section-title" class="section-title">YouTube Thumbnail Downloader</h2>
    <div class="input-container">
      <input
        type="text"
        id="youtube-url"
        placeholder="Paste YouTube Video URL..."
        autocomplete="off"
        aria-label="YouTube Video URL"
      />
      <select id="quality" title="Select Thumbnail Quality" aria-label="Thumbnail Quality">
        <option value="maxresdefault">Max Resolution</option>
        <option value="hqdefault">High Quality</option>
        <option value="mqdefault">Medium Quality</option>
        <option value="sddefault">Standard Definition</option>
      </select>
      <button id="download-btn">Get Thumbnail</button>
    </div>

    <div id="message" aria-live="polite"></div>
    <div id="result" aria-live="polite"></div>
    <button id="copy-share-btn" style="display:none;">🔗 Copy Shareable Link</button>
    <div id="copy-status"></div>
    <div id="recent-searches"></div>
  </section>

  <!-- Shorts Downloader Section -->
  <section aria-labelledby="shorts-section-title">
    <h2 id="shorts-section-title" class="section-title">YouTube Shorts Downloader</h2>
    <div class="input-container">
      <input
        type="text"
        id="shorts-url"
        placeholder="Paste YouTube Shorts URL (e.g. https://youtube.com/shorts/VIDEOID)"
        autocomplete="off"
        aria-label="YouTube Shorts URL"
      />
      <button id="shorts-download-btn">Get Shorts Video</button>
    </div>

    <div id="shorts-message" aria-live="polite"></div>
    <div id="shorts-result" aria-live="polite"></div>
  </section>

  <!-- Admin Analytics Section -->
  <div id="admin-controls" style="display:none;">
    <button id="view-analytics">View Analytics (JSON)</button>
    <pre id="analytics-output"></pre>
    <canvas id="analytics-chart"></canvas>
  </div>

  <script>
    // Elements for Thumbnail Downloader
    const inputURL = document.getElementById('youtube-url');
    const qualitySelect = document.getElementById('quality');
    const downloadBtn = document.getElementById('download-btn');
    const resultDiv = document.getElementById('result');
    const messageDiv = document.getElementById('message');
    const copyShareBtn = document.getElementById('copy-share-btn');
    const copyStatus = document.getElementById('copy-status');
    const recentSearchesDiv = document.getElementById('recent-searches');

    // Elements for Shorts Downloader
    const shortsInput = document.getElementById('shorts-url');
    const shortsBtn = document.getElementById('shorts-download-btn');
    const shortsResultDiv = document.getElementById('shorts-result');
    const shortsMessageDiv = document.getElementById('shorts-message');

    // Admin elements
    const adminControls = document.getElementById('admin-controls');
    const viewAnalyticsBtn = document.getElementById('view-analytics');
    const analyticsOutput = document.getElementById('analytics-output');
    const analyticsChartCanvas = document.getElementById('analytics-chart');

    // Extract video ID robustly for thumbnails (normal YouTube URLs)
    function extractVideoID(url) {
      if (!url) return null;
      const patterns = [
        /(?:https?:\/\/)?(?:www\.)?youtu\.be\/([0-9A-Za-z_-]{11})/,
        /(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\?v=([0-9A-Za-z_-]{11})/,
        /(?:https?:\/\/)?(?:www\.)?youtube\.com\/embed\/([0-9A-Za-z_-]{11})/,
        /(?:https?:\/\/)?(?:www\.)?youtube\.com\/v\/([0-9A-Za-z_-]{11})/,
        /(?:https?:\/\/)?(?:www\.)?youtube\.com\/shorts\/([0-9A-Za-z_-]{11})/
      ];
      for (const pattern of patterns) {
        const match = url.match(pattern);
        if (match && match[1]) return match[1];
      }
      return null;
    }

    // Extract Shorts video ID specifically from shorts URLs
    function extractShortsID(url) {
      if (!url) return null;
      const shortsPattern = /(?:https?:\/\/)?(?:www\.)?youtube\.com\/shorts\/([0-9A-Za-z_-]{11})/;
      const match = url.match(shortsPattern);
      return match ? match[1] : null;
    }

    // Load and save recent searches (for thumbnails)
    function loadRecentSearches() {
      const searches = JSON.parse(localStorage.getItem('recentSearches') || '[]');
      return searches;
    }
    function saveRecentSearches(searches) {
      localStorage.setItem('recentSearches', JSON.stringify(searches));
    }
    function renderRecentSearches() {
      const searches = loadRecentSearches();
      if (searches.length === 0) {
        recentSearchesDiv.innerHTML = '';
        return;
      }
      recentSearchesDiv.innerHTML =
        '<p style="margin-bottom:8px; font-weight:600; user-select:none;">🔁 Recent Searches:</p>' +
        searches
          .map(
            (url) =>
              `<button type="button" aria-label="Search for ${url}" onclick="fillURL('${url}')">${url}</button>`
          )
          .join('');
    }
    function fillURL(url) {
      inputURL.value = url;
      messageDiv.textContent = '';
      resultDiv.innerHTML = '';
      copyShareBtn.style.display = 'none';
      copyStatus.textContent = '';
    }
    window.fillURL = fillURL; // expose globally for recent search buttons

    // Add to recent searches (max 5)
    function addToRecentSearches(url) {
      if (!url) return;
      let searches = loadRecentSearches();
      searches = searches.filter((u) => u !== url);
      searches.unshift(url);
      if (searches.length > 5) searches = searches.slice(0, 5);
      saveRecentSearches(searches);
      renderRecentSearches();
    }

    // Analytics: track downloads per videoId
    function trackDownload(videoId) {
      if (!videoId) return;
      const analytics = JSON.parse(localStorage.getItem('analytics') || '{}');
      const date = new Date().toLocaleDateString();
      if (!analytics[videoId]) analytics[videoId] = { count: 0, lastUsed: null };
      analytics[videoId].count += 1;
      analytics[videoId].lastUsed = date;
      localStorage.setItem('analytics', JSON.stringify(analytics));
    }
    function getAnalytics() {
      return JSON.parse(localStorage.getItem('analytics') || '{}');
    }
    function renderChart(data) {
      if (!analyticsChartCanvas) return;
      const ctx = analyticsChartCanvas.getContext('2d');
      if (window.analyticsChartInstance) {
        window.analyticsChartInstance.destroy();
      }
      const labels = Object.keys(data);
      const counts = labels.map((id) => data[id].count);
      window.analyticsChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels,
          datasets: [
            {
              label: 'Download Count',
              data: counts,
              backgroundColor: '#ff0000',
            },
          ],
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true },
          },
        },
      });
    }

    // Copy shareable link for thumbnails
    copyShareBtn.addEventListener('click', () => {
      const inputVal = inputURL.value.trim();
      if (!inputVal) return;
      const shareURL =
        location.origin + location.pathname + '?url=' + encodeURIComponent(inputVal);
      navigator.clipboard
        .writeText(shareURL)
        .then(() => {
          copyStatus.textContent = '🔗 Shareable link copied!';
          setTimeout(() => (copyStatus.textContent = ''), 3000);
        })
        .catch(() => {
          copyStatus.textContent = '❌ Failed to copy share link.';
        });
    });

    // Thumbnail downloader button click
    downloadBtn.addEventListener('click', () => {
      const url = inputURL.value.trim();
      const quality = qualitySelect.value;
      messageDiv.textContent = '';
      copyStatus.textContent = '';
      resultDiv.innerHTML = '';
      copyShareBtn.style.display = 'none';

      const videoId = extractVideoID(url);
      if (!videoId) {
        messageDiv.textContent = '❌ Invalid YouTube URL. Please try again.';
        messageDiv.className = 'error';
        return;
     
